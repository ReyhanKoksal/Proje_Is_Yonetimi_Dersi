//(ogrencı_frm.vb içi )


Public Class ogrenci_frm
    Dim ogrenci As New ogrenci_bilgi
    Public et As Integer
    Public nokta As Integer
    Public et1 As Integer
    Public nokta1 As Integer

Sub bilgi_ata()
        ogrenci.o_numarası = CInt(sicil_no_txt.Text)
        ogrenci.o_adi = sicil_ad_txt.Text
        ogrenci.o_soyadi = sicil_soyad_txt.Text
        If sicil_erkek_rd.Checked Then
            ogrenci.o_cinsiyeti = "Erkek"
        Else
            ogrenci.o_cinsiyeti = "Kız"
        End If
        ogrenci.o_dogumtarihi = sicil_dog_tar_dtp.Value.ToString
        ogrenci.o_adresi = sicil_adres_txt.Text
        ogrenci.o_ili = sicil_il_txt.Text
        ogrenci.o_ilcesi = sicil_ilcesi_txt.Text
        ogrenci.o_posta_kodu = sicil_posta_txt.Text
        ogrenci.o_evtelefonu = sicil_evtel_txt.Text
        ogrenci.o_ceptelefonu = sicil_ceptel_txt.Text
        ogrenci.o_email = sicil_email_txt.Text
        ogrenci.o_bolumu = CInt(ogr_sicil_bolum_txt.SelectedItem)
    End Sub

Private Sub ogr_sicil_ekle_btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_ekle_btn.Click
        If sicil_no_txt.Text = "" Then
            MsgBox("Öğrenci Numarası Boş Geçilemez!!!", MsgBoxStyle.Exclamation)
            sicil_no_txt.Focus()

        ElseIf sicil_ad_txt.Text = "" Then
            MsgBox("Öğrenci Adı Boş Geçilemez!!!")
            sicil_ad_txt.Focus()

        ElseIf sicil_soyad_txt.Text = "" Then
            MsgBox("Öğrenci Soyadı Boş Geçilemez!!!", MsgBoxStyle.Exclamation)
            sicil_soyad_txt.Focus()

        ElseIf IsNumeric(sicil_no_txt.Text) = False And sicil_no_txt.Text <> "" Then
            MsgBox("Lütfen Geçerli Bir Öğrenci Numarası Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_no_txt.Text = ""
            sicil_no_txt.Focus()

        ElseIf IsNumeric(sicil_ad_txt.Text) = True And sicil_ad_txt.Text <> "" Then
            MsgBox("Lütfen Geçerli Bir Öğrenci Adı Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_ad_txt.Text = ""
            sicil_ad_txt.Focus()

        ElseIf IsNumeric(sicil_soyad_txt.Text) = True And sicil_soyad_txt.Text <> "" Then
            MsgBox("Lütfen Geçerli Bir Öğrenci SoyAdı Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_soyad_txt.Text = ""
            sicil_soyad_txt.Focus()

        ElseIf IsNumeric(sicil_il_txt.Text) = True And sicil_il_txt.Text <> "" Then
            MsgBox("Lütfen İl Bölümüne Geçerli Bir Değer Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_il_txt.Text = ""
            sicil_il_txt.Focus()
        ElseIf IsNumeric(sicil_ilcesi_txt.Text) = True And sicil_ilcesi_txt.Text <> "" Then
            MsgBox("Lütfen İlçe Bölümüne Geçerli Bir Değer Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_ilcesi_txt.Text = ""
            sicil_ilcesi_txt.Focus()

        ElseIf IsNumeric(sicil_posta_txt.Text) = False And sicil_posta_txt.Text <> "" Then
            MsgBox("Lütfen Posta Kodu Bölümüne Geçerli Bir Değer Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_posta_txt.Text = ""
            sicil_posta_txt.Focus()

        ElseIf IsNumeric(sicil_posta_txt.Text) = False And sicil_posta_txt.Text <> "" Then
            MsgBox("Lütfen Posta Kodu Bölümüne Geçerli Bir Değer Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_posta_txt.Text = ""
            sicil_posta_txt.Focus()

        ElseIf IsNumeric(sicil_evtel_txt.Text) = False And sicil_evtel_txt.Text <> "" Then
            MsgBox("Lütfen Ev Telefonu Bölümüne Geçerli Bir Değer Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_evtel_txt.Text = ""
            sicil_evtel_txt.Focus()

        ElseIf IsNumeric(sicil_ceptel_txt.Text) = False And sicil_ceptel_txt.Text <> "" Then
            MsgBox("Lütfen Cep Telefonu Bölümüne Geçerli Bir Değer Giriniz!!!", MsgBoxStyle.Exclamation)
            sicil_ceptel_txt.Text = ""
            sicil_ceptel_txt.Focus()
        Else
            ogrenci.kontrol()

        End If
    End Sub
    Private Sub ogr_sicil_sil_btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_sil_btn.Click
        If (sicil_no_txt.Text = "") Then
            MsgBox("Lütfen kaydı silinecek öğrencinin numarası giriniz", MsgBoxStyle.Exclamation)
            sicil_no_txt.Focus()
            Return
        End If
        ogrenci.o_numarası = CInt(sicil_no_txt.Text)
        ogrenci.sil()
    End Sub
    Private Sub ogr_sicil_ara_btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_ara_btn.Click
        If (sicil_no_txt.Text = "") Then
            MsgBox("Lütfen aranacak bir öğrenci numarası giriniz", MsgBoxStyle.Exclamation)
            sicil_no_txt.Focus()
            Return
        End If
        bilgi_ata()
        ogrenci.ara()

    End Sub

    Private Sub ogr_sicil_listele_btn_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_listele_btn.Click
        ogrenci.listele()
    End Sub

    Private Sub ogr_sicil_guncelle_btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_guncelle_btn.Click
        If sicil_no_txt.Text = "" Then
            MsgBox("Lütfen güncellenecek olan öğrencinin numarasını giriniz", MsgBoxStyle.Exclamation)
            sicil_no_txt.Focus()
            Return
        End If
        bilgi_ata()
        ogrenci.guncelle()
    End Sub

    Private Sub ogr_sicil_temizle_btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_temizle_btn.Click
        ogrenci.temizle()
    End Sub

    Private Sub ogr_sicil_cikis_btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ogr_sicil_cikis_btn.Click
        ogrenci.cikis()
    End Sub


// Ogrenci_bilgi vb (Class tanımlamaları)

Imports System.Data.SqlClient

Public Class ogrenci_bilgi
    Private no As Integer
    Private ad As String
    Private soyad As String
    Private cinsiyet As String
    Private dogtar As String
    Private il As String
    Private ilce As String
    Private postakodu As String
    Private evtel As String
    Private ceptel As String
    Private email As String
    Private adres As String
    Private bolum As Integer
    
    Private sql As String
    Private baglanti As New SqlConnection("server=.\SQLEXPRESS; database=proje; trusted_connection=yes;")
    Private com As New SqlCommand()
    Sub kontrol()
        ogrenci_frm.bilgi_ata()
        no = CInt(ogrenci_frm.sicil_no_txt.Text)
        sql = "select * from ogrenci_sicil_tbl where numarasi = '" & no & "'"
        baglan()
        Dim satir1 As DataRow
        Dim adapt As New SqlDataAdapter(sql, baglanti)
        Dim ds As New DataSet("ds")
        adapt.Fill(ds, "Kontrol")
Try
            satir1 = ds.Tables("Kontrol").Rows(0)
            MsgBox("Bu numaraya sahip bir kayıt zaten var!")
            ogrenci_frm.sicil_no_txt.Focus()

        Catch
            If ogrenci_frm.sicil_email_txt.Text = "" Then
                ekle()
            Else
                If ogrenci_frm.et = 1 And ogrenci_frm.nokta = 1 Then
                    ekle()
                Else
                    MsgBox("Geçersiz E-Mail Adresi! Lütfen Kontrol Ediniz")
                End If
            End If
    End Sub
    
    Sub baglan()
        com.Connection = baglanti
        com.CommandText = sql
        baglanti.Open()
        com.ExecuteNonQuery()
        baglanti.Close()
    End Sub
    Sub listele()
        sql = "select * from ogrenci_sicil_tbl"
        Dim adapt As New SqlDataAdapter(sql, baglanti)
        Dim ds As New DataSet()
        adapt.Fill(ds, "ogr_liste")
        ogrenci_frm.ogrenci_sicil_grd.DataSource = ds.Tables("ogr_liste")

ogrenci_frm.ogrenci_sicil_grd.Refresh()
        ogrenci_frm.ogrenci_sicil_grd.Columns(0).HeaderText = "Numarası"
        ogrenci_frm.ogrenci_sicil_grd.Columns(1).HeaderText = "Adı"
        ogrenci_frm.ogrenci_sicil_grd.Columns(2).HeaderText = "Soyadı"
        ogrenci_frm.ogrenci_sicil_grd.Columns(3).HeaderText = "Cinsiyeti"
        ogrenci_frm.ogrenci_sicil_grd.Columns(4).HeaderText = "Doğum Tarihi"
        ogrenci_frm.ogrenci_sicil_grd.Columns(5).HeaderText = "Adresi"
        ogrenci_frm.ogrenci_sicil_grd.Columns(6).HeaderText = "İli"
        ogrenci_frm.ogrenci_sicil_grd.Columns(7).HeaderText = "İlçesi"
        ogrenci_frm.ogrenci_sicil_grd.Columns(8).HeaderText = "Posta Kodu"
        ogrenci_frm.ogrenci_sicil_grd.Columns(9).HeaderText = "Ev Telefonu"
        ogrenci_frm.ogrenci_sicil_grd.Columns(10).HeaderText = "Cep Telefonu"
        ogrenci_frm.ogrenci_sicil_grd.Columns(11).HeaderText = "E-mail"
        ogrenci_frm.ogrenci_sicil_grd.Columns(12).HeaderText = "Bölüm Kodu"
    End Sub
    Sub temizle()
        ogrenci_frm.sicil_no_txt.Text = ""
        ogrenci_frm.sicil_ad_txt.Text = ""
        ogrenci_frm.sicil_soyad_txt.Text = ""
        ogrenci_frm.sicil_adres_txt.Text = ""
        ogrenci_frm.sicil_il_txt.Text = ""
        ogrenci_frm.sicil_ilcesi_txt.Text = ""
        ogrenci_frm.sicil_posta_txt.Text = ""
        ogrenci_frm.sicil_evtel_txt.Text = ""
        ogrenci_frm.sicil_ceptel_txt.Text = ""
        ogrenci_frm.sicil_email_txt.Text = ""
    End Sub
Sub ekle()
        sql = "INSERT INTO ogrenci_sicil_tbl(numarasi,adi,soyadi,cinsiyeti,d_tarihi,adresi,ili,ilcesi,p_kodu,ev_tel,cep_tel,email,b_kodu) values ('" & no & "','" & ad & "','" & soyad & "','" & cinsiyet & "','" & dogtar & "','" & adres & "','" & il & "','" & ilce & "','" & postakodu & "','" & evtel & "','" & ceptel & "','" & email & "','" & bolum & "')"
        baglan()
        listele()
    End Sub

    Sub guncelle()
        sql = "update ogrenci_sicil_tbl set numarasi = '" & no & "', adi='" & ad & "', soyadi='" & soyad & "', cinsiyeti='" & cinsiyet & "', d_tarihi='" & dogtar & "', adresi='" & adres & "', ili='" & il & "', ilcesi='" & ilce & "', p_kodu='" & postakodu & "', ev_tel='" & evtel & "', cep_tel='" & ceptel & "', email='" & email & "',b_kodu='" & bolum & "' where numarasi = '" & no & "'"
        baglan()
        listele()
    End Sub

    Sub sil()
        sql = "delete from ogrenci_sicil_tbl where numarasi='" & no & "'"
        baglan()
        listele()
    End Sub

    Sub ara()
        sql = "select * from ogrenci_sicil_tbl where numarasi='" & no & "'"
        Dim adapt As New SqlDataAdapter(sql, baglanti)
        Dim ds As New DataSet()
        adapt.Fill(ds, "Ogrenci Listesi")
        ogrenci_frm.ogrenci_sicil_grd.DataSource = ds.Tables("Ogrenci Listesi")
        ogrenci_frm.ogrenci_sicil_grd.Refresh()

    End Sub

    Sub cikis()
        End
    End Sub

    Public Property o_numarası()
        Get
            Return no
        End Get
        Set(ByVal value)
            no = value
        End Set
    End Property
    Public Property o_bolumu()
        Get
            Return bolum
        End Get
        Set(ByVal value)
            bolum = value
        End Set
    End Property

    Public Property o_adi()
        Get
            Return ad
        End Get
        Set(ByVal value)
            ad = value
        End Set
    End Property

    Public Property o_soyadi()
        Get
            Return soyad
        End Get
        Set(ByVal value)
            soyad = value
        End Set
    End Property

    Public Property o_cinsiyeti()
        Get
            Return cinsiyet
        End Get
        Set(ByVal value)
            cinsiyet = value
        End Set
    End Property
    Public Property o_dogumtarihi()
        Get
            Return dogtar
        End Get
        Set(ByVal value)
            dogtar = value
        End Set
    End Property
    Public Property o_ili()
        Get
            Return il
        End Get
        Set(ByVal value)
            il = value
        End Set
    End Property
    Public Property o_ilcesi()
        Get
            Return ilce
        End Get
        Set(ByVal value)
            ilce = value
        End Set
    End Property
    Public Property o_posta_kodu()
        Get
            Return postakodu
        End Get
        Set(ByVal value)
            postakodu = value
        End Set
    End Property

    Public Property o_evtelefonu()
        Get
            Return evtel
        End Get
        Set(ByVal value)
            evtel = value
        End Set
    End Property
    Public Property o_ceptelefonu()
        Get
            Return ceptel
        End Get
        Set(ByVal value)
            ceptel = value
        End Set
    End Property

    Public Property o_email()
        Get
            Return email
        End Get
        Set(ByVal value)
            email = value
        End Set
    End Property
    Public Property o_adresi()
        Get
            Return adres
        End Get
        Set(ByVal value)
            adres = value
        End Set
    End Property
End Class

